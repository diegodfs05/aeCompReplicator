(function(z){function H(b){return atobPoly(b)}function atobPoly(b){if(typeof _ab!=="undefined")return _ab(b);var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="",n=0,r=0,e;for(b=b.replace(/=+$/,"");r<b.length;r++){e=a.indexOf(b.charAt(r));if(~e){n=n<<6|e;var c=r%4;if(c===3){o+=String.fromCharCode((16711680&n)>>16,(65280&n)>>8,255&n)}}}var s=r%4;if(s===1)throw new Error("atobPoly: bad encoding");if(s===2)o+=String.fromCharCode((16711680&n)>>16);else if(s===3)o+=String.fromCharCode((16711680&n)>>16,(65280&n)>>8);return o}if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(typeof JSON==="undefined"){JSON={parse:function(b){return eval("("+b+")")},stringify:function(){throw new Error("JSON.stringify not implemented.")}}}if(typeof Array.isArray==="undefined"){Array.isArray=function(b){return Object.prototype.toString.call(b)==="[object Array]"}}var mainPanel,compDropdown,reloadBtn,formatDropdown,jsonLabel,browseBtn,fieldsCountInput,setFieldsBtn,fieldsGroup,layerSelectors=[],processBtn;function buildUI(A){var B=A instanceof Panel?A:new Window("palette",H("UmVwbGljYWRvciBkZSBDb21w"),undefined,{resizeable:true});mainPanel=B;B.orientation="column";B.alignChildren=["fill","top"];B.add("statictext",undefined,H("U2VsZWNpb25lIGEgQ29tcG9zacOnw6NvOg=="));(function(){var a=B.add("group");a.orientation="row";a.alignChildren=["fill","center"];a.alignment=["fill","top"];compDropdown=a.add("dropdownlist",undefined,[]);compDropdown.alignment=["fill","center"];reloadBtn=a.add("button",undefined,H("UmVjYXJyZWdhciBDb21wb3M="))})();B.add("statictext",undefined,H("U2VsZWNpb25lIG8gRm9ybWF0byBkZSBBcXVpdm8gZGUgRGFkb3M6"));(function(){var a=B.add("group");a.orientation="row";a.alignChildren=["fill","center"];a.alignment=["fill","top"];formatDropdown=a.add("dropdownlist",undefined,[H("SlNPTg=="),H("Q1NW")]);formatDropdown.selection=0;formatDropdown.alignment=["fill","center"]})();B.add("statictext",undefined,H("U2VsZWNpb25lIG8gQXJxdWl2bzoo"));(function(){var a=B.add("group");a.orientation="row";a.alignChildren=["fill","center"];a.alignment=["fill","top"];jsonLabel=a.add("statictext",undefined,H("TmVuaHVtIGFycXVpdm8gc2VsZWNpb25hZG8="));jsonLabel.alignment=["fill","center"];jsonLabel.preferredSize.width=200;browseBtn=a.add("button",undefined,H("UHJvY3VyYXIgQXJxdWl2by4uLg=="));browseBtn.alignment=["right","center"]})();B.add("statictext",undefined,H("TsOjbWVyb8OgIGRlIGNhbWFkYXMgZGUgdGV4dG8gYSBwcm9jZXNzYXI6"));(function(){var a=B.add("group");a.orientation="row";a.alignChildren=["fill","center"];a.alignment=["fill","top"];fieldsCountInput=a.add("edittext",undefined,"0");fieldsCountInput.characters=4;fieldsCountInput.alignment=["left","center"];setFieldsBtn=a.add("button",undefined,H("RGVmaW5pciBDYW1wb3M="));setFieldsBtn.alignment=["right","center"]})();fieldsGroup=B.add("group");fieldsGroup.orientation="column";fieldsGroup.alignChildren=["fill","top"];fieldsGroup.alignment=["fill","top"];processBtn=B.add("button",undefined,H("UmVwbGljYXIgQ29tcHM="));processBtn.alignment=["fill","top"];reloadBtn.onClick=function(){populateCompList()};browseBtn.onClick=function(){var a=formatDropdown.selection?formatDropdown.selection.text:"JSON",b=a==="CSV"?"*.csv":"*.json",c=File.openDialog(H("U2VsZWNpb25lIGFyY2hpdm8g")+a,b);if(c&&c.exists){jsonLabel.text=decodeURI(c.fsName)}};setFieldsBtn.onClick=function(){clearLayerSelectors();var a=parseInt(fieldsCountInput.text,10);if(isNaN(a)||a<1){alert(H("UG9yIGZhdm9yLCBpbnNpcmEgdW0gbnVtZXJvIHZhbMOtc2RvIGUgcG9zaXRpdm8gZGUgY2FtYWRhcyBkZSB0ZXh0by4="));return}createFieldSelectors(a)};processBtn.onClick=replicateComps;populateCompList();if(B instanceof Window){B.center();B.show()}return B}function populateCompList(){if(!compDropdown)return;compDropdown.removeAll();var a=app.project;if(a&&a.numItems>0){for(var b=1;b<=a.numItems;b++){var c=a.item(b);if(c instanceof CompItem){compDropdown.add("item",c.name)}}if(compDropdown.items.length>0)compDropdown.selection=0}}function createFieldSelectors(a){var b=compDropdown.selection?compDropdown.selection.text:null;if(!b){alert(H("TmVuaHVtYSBjb21wb3NpY2FvIMOgIHNlbGVjaW9uYWRhLg=="));return}var c=findCompByName(b);if(!c){alert(H("Q29tcG9zacOnw6NvIHNlbGVjaW9uYWRhIG7Do28gZm9pIGVua29udHJhZGEu"));return}var d=[];for(var e=1;e<=c.numLayers;e++){var f=c.layer(e);if(f.matchName==="ADBE Text Layer")d.push(f.name)}for(var g=0;g<a;g++){var h=fieldsGroup.add("group");h.orientation="row";h.alignChildren=["fill","center"];h.alignment=["fill","top"];var i=h.add("dropdownlist",undefined,d);i.alignment=["fill","center"];if(d.length>0)i.selection=0;layerSelectors.push(i)}fieldsGroup.layout.layout(true);mainPanel.layout.layout(true)}function clearLayerSelectors(){while(fieldsGroup.children.length>0){fieldsGroup.remove(fieldsGroup.children[0])}layerSelectors=[];fieldsGroup.layout.layout(true);mainPanel.layout.layout(true)}function replicateComps(){app.beginUndoGroup(H("UmVwbGlpY2FyIENvbXBz"));try{var a=app.project;if(!a){alert(H("TmVuaHVtIHByb2pldG8gYWJlcnRvLg=="));return}if(!compDropdown.selection){alert(H("U2VsZWNpb25lIHVtYSBjb21wb3NpY2FvIHByaW1laXJvLg=="));return}var b=compDropdown.selection.text,c=findCompByName(b);if(!c){alert(H("QSBjb21wb3NpY2FvIHNlbGVjaW9uYWRhIG7Do28gZm9pIGVua29udHJhZGEgbm8gcHJvamV0by4="));return}var d=formatDropdown.selection?formatDropdown.selection.text:"JSON",e=jsonLabel.text;if(!e||e===H("TmVuaHVtIGFycXVpdm8gc2VsZWNpb25hZG8=")){alert(H("UG9yIGZhdm9yLCBzZWxlY2lvbmUgdW0gYXJxdWl2byBkZSBkYWRvcyAo")+d+H("KS4="));return}var f=new File(e);if(!f.exists){alert(H("TyBhcXF1aXZvIGRlIGRhZG9zIHNlbGVjaW9uYWRvIMOgbyBleGlzdGUu"));return}f.open("r");var g=f.read();f.close();var h=parseDataFile(d,g);if(!h||!Array.isArray(h)||h.length===0){alert(H("TsOhbyBmb3JhbSBlbmNvbnRyYWRhcyBsaW5oYXMgdsOtbGlkYXMgbm8gYXJxdWl2byA=")+d+H("Lg=="));return}if(layerSelectors.length===0){alert(H("TmVuaHVtIGNhbXBvIGRlIHRleHRvIGZvaSBjb25maWd1cmFkby4gQ2xpcXVlIGVtIFwiRGVmaW5pciBDYW1wb3NcIiBkZXBvaXMgZGUgZXNwZWNpZmljYXIgdW0gbnVtZXJvLg=="));return}for(var i=0;i<h.length;i++){var j=h[i],k=c.duplicate();k.name=c.name+"_"+(i+1);for(var l=0;l<layerSelectors.length;l++){if(l>=j.length)break;var m=layerSelectors[l].selection?layerSelectors[l].selection.text:null;if(!m)continue;var n=findLayerByName(k,m);if(!n)continue;var o=n.property("Source Text");if(o){var p=o.value;p.text=String(j[l]);o.setValue(p)}}}alert(H("Rm9yYW0gcmVwbGljYWRhcyA=")+h.length+H("IGNvbXBvc2nDumVzIGNvbSBzdWNlc3NvIQ=="))}catch(q){alert(H("RXJybyog")+q.toString())}finally{app.endUndoGroup()}}function parseDataFile(a,b){var c=[];if(a==="CSV"){var d=b.split("\n");for(var e=0;e<d.length;e++){var f=d[e].replace(/\r$/,"").trim();if(f==="")continue;var g=f.split(";");for(var h=0;h<g.length;h++){var i=g[h].trim().replace(/^"(.*)"$/,"$1");g[h]=i}c.push(g)}}else{var j=JSON.parse(b);if(!Array.isArray(j)){alert(H("TyBKU09OIGRlYmUgc2VyIHVtIGFycmF5IChkZSBvYmpldG9zIHNldSBhcnJheXMpLg=="));return null}if(Array.isArray(j[0]))c=j;else{for(var k=0;k<j.length;k++){var l=j[k],m=[];for(var n in l)if(l.hasOwnProperty(n))m.push(l[n]);c.push(m)}}}return c}function findCompByName(a){var b=app.project;if(!b)return null;for(var c=1;c<=b.numItems;c++){var d=b.item(c);if(d instanceof CompItem&&d.name===a)return d}return null}function findLayerByName(a,b){for(var c=1;c<=a.numLayers;c++){var d=a.layer(c);if(d.name===b)return d}return null}var myScriptPal=buildUI(z);if(!(myScriptPal instanceof Window))myScriptPal.layout.layout(true)})(this);
